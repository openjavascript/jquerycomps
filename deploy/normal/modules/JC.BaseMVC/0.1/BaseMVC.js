(function(define,_win){define(["JC.common"],function(){function BaseMVC(e){throw new Error("JC.BaseMVC is an abstract class, can't initialize!")}return window.BaseMVC=JC.BaseMVC=BaseMVC,BaseMVC.prototype={_init:function(){var e=this;return $([e._view,e._model]).on("BindEvent",function(t,n,r){e.on(n,r)}),$([e._view,e._model]).on("TriggerEvent",function(t,n){var r=JC.f.sliceArgs(arguments).slice(2);e.trigger(n,r)}),e._beforeInit(),e._initHanlderEvent(),e._model.init(),e._view&&e._view.init(),e._inited(),e},_beforeInit:function(){},_initHanlderEvent:function(){},_inited:function(){},selector:function(){return this._model.selector()},on:function(e,t){return $(this).on(e,t),this},trigger:function(e,t){return $(this).trigger(e,t),this}},BaseMVC.getInstance=function(e,t,n){return typeof e=="string"&&!/</.test(e)&&(e=$(e)),!e||!e.length||typeof e=="string"?null:(t.Model._instanceName=t.Model._instanceName||"CommonIns",typeof n!="undefined"&&e.data(t.Model._instanceName,n),e.data(t.Model._instanceName))},BaseMVC.autoInit=!0,BaseMVC.build=function(e,t){t=t||BaseMVC,typeof t=="string"&&(t=BaseMVC),BaseMVC.buildModel(e),BaseMVC.buildView(e),BaseMVC.buildClass(t,e),t.Model&&BaseMVC.buildClass(t.Model,e.Model),t.View&&BaseMVC.buildClass(t.View,e.View)},BaseMVC.buildClass=function(e,t){if(!e||!t)return;var n,r,i;if(t){for(n in e)t[n]||e[n].constructor!=Function&&(t[n]=e[n]);for(n in e.prototype)!t.prototype[n]&&(t.prototype[n]=e.prototype[n])}},BaseMVC.buildModel=function(e){!e.Model&&(e.Model=function(e){this._selector=e},e.Model._instanceName="CommonIns")},BaseMVC.buildView=function(e){!e.View&&(e.View=function(e){this._model=e})},BaseMVC.buildModel(BaseMVC),BaseMVC.buildView(BaseMVC),BaseMVC.Model._instanceName="BaseMVCIns",JC.f.extendObject(BaseMVC.Model.prototype,{init:function(){return this},on:function(){return $(this).trigger("BindEvent",JC.f.sliceArgs(arguments)),this},trigger:function(e,t){return t=t||[],t.unshift(e),$(this).trigger("TriggerEvent",t),this},selector:function(e){return typeof e!="undefined"&&(this._selector=e),this._selector},intProp:function(e,t){typeof t=="undefined"?(t=e,e=this.selector()):e&&(e=$(e));var n=0;return e&&e.is("["+t+"]")&&(n=parseInt(e.attr(t).trim(),10)||n),n},floatProp:function(e,t){typeof t=="undefined"?(t=e,e=this.selector()):e&&(e=$(e));var n=0;return e&&e.is("["+t+"]")&&(n=parseFloat(e.attr(t).trim())||n),n},stringProp:function(e,t){typeof t=="undefined"?(t=e,e=this.selector()):e&&(e=$(e));var n=(this.attrProp(e,t)||"").toLowerCase();return n},attrProp:function(e,t){typeof t=="undefined"?(t=e,e=this.selector()):e&&(e=$(e));var n="";return e&&e.is("["+t+"]")&&(n=e.attr(t).trim()),n},boolProp:function(e,t,n){typeof t=="boolean"?(n=t,t=e,e=this.selector()):typeof t=="undefined"?(t=e,e=this.selector()):e&&(e=$(e));var r=undefined;return e&&e.is("["+t+"]")&&(r=JC.f.parseBool(e.attr(t).trim())),r},callbackProp:function(e,t){typeof t=="undefined"?(t=e,e=this.selector()):e&&(e=$(e));var n,r;return e&&e.is("["+t+"]")&&(r=window[e.attr(t)])&&(n=r),n},windowProp:function(){return this.callbackProp.apply(this,JC.f.sliceArgs(arguments))},selectorProp:function(e,t){var n;return typeof t=="undefined"?(t=e,e=this.selector()):e&&(e=$(e)),e&&e.is("["+t+"]")&&(n=JC.f.parentSelector(e,e.attr(t))),n},scriptTplProp:function(e,t){var n="",r;return typeof t=="undefined"?(t=e,e=this.selector()):e&&(e=$(e)),e&&e.is("["+t+"]")&&(r=JC.f.parentSelector(e,e.attr(t)))&&r.length&&(n=JC.f.scriptContent(r)),n},jsonProp:function(_selector,_key){var _r;return typeof _key=="undefined"?(_key=_selector,_selector=this.selector()):_selector&&(_selector=$(_selector)),_selector&&_selector.is("["+_key+"]")&&(_r=eval("("+_selector.attr(_key)+")")),_r},is:function(e,t){return typeof t=="undefined"?(t=e,e=this.selector()):e&&(e=$(e)),e&&e.is(t)}}),JC.f.extendObject(BaseMVC.View.prototype,{init:function(){return this},selector:function(){return this._model.selector()},on:function(){return $(this).trigger("BindEvent",JC.f.sliceArgs(arguments)),this},trigger:function(e,t){return t=t||[],t.unshift(e),$(this).trigger("TriggerEvent",t),this}}),JC.BaseMVC})})(typeof define=="function"&&define.amd?define:function(e,t,n){typeof e=="function"&&(n=e),typeof t=="function"&&(n=t),n&&n()},window);