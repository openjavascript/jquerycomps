<!doctype html>
<html>
<head>
<meta charset=utf-8 />
<title>360 75 team</title>
<style>
    body{ width: 680px; margin: 20px auto; }
</style>
<link href='../../../../modules/JC.AjaxTree/0.1/res/default/style.css' rel='stylesheet' />
<script src="../../../../lib.js"></script>
<script src="../../../../config.js"></script>
<script>
    JC.debug = 1;

    requirejs( [ 'JC.AjaxTree' ], function( Tree ){
    });

    $(document).delegate('button.js_open_all', 'click', function(){
        $('div.js_compAjaxTree').each( function( _k ){
            JC.BaseMVC.getInstance( this, JC.AjaxTree ) && JC.BaseMVC.getInstance(this, JC.AjaxTree ).open();
        });
    });

    $(document).delegate('button.js_close_all', 'click', function(){
        $('div.js_compAjaxTree').each( function(){
            JC.BaseMVC.getInstance( this, JC.AjaxTree ) && JC.BaseMVC.getInstance(this, JC.AjaxTree ).close();
        });
    });

    $(document).delegate('button.js_open_for', 'click', function(){
    
        var _tgr = $(this).attr('data_target');
        if( !_tgr ) return;
        _tgr = $.trim( $( _tgr ).val() );

        $('div.js_compAjaxTree').each( function(){
            JC.BaseMVC.getInstance( this, JC.AjaxTree ) && JC.BaseMVC.getInstance( this, JC.AjaxTree ).open( _tgr );
        });
    });

    $(document).delegate('button.js_close_for', 'click', function(){
    
        var _tgr = $(this).attr('data_target');
        if( !_tgr ) return;
        _tgr = $.trim( $( _tgr ).val() );

        $('div.js_compAjaxTree').each( function(){
            JC.BaseMVC.getInstance( this, JC.AjaxTree ) && JC.BaseMVC.getInstance( this, JC.AjaxTree ).close( _tgr );
        });
    });

    $( document ).delegate( 'div.js_compAjaxTree', 'change', function( _evt, _item, _data, _box ){
        //JC.dir( _item[0], _data, _box[0] );
        JC.log( 'change', _data );
    });

</script>
</head>    
<body>
    <div style="position:fixed; right: 10px; top: 0px;">
        <dl>
            <dd>
            <a href="?">back</a>
            <button type="button" class="js_open_all">open all</button>
            <button type="button" class="js_close_all">close all</button>
            <button type="button" class="js_open_for" data_target="#open_to_val">open for</button>
            <input type="text" value="0,03,35,36" id="open_to_val" />
            <button type="button" class="js_close_for" data_target="#open_to_val">close for</button>
            </dd>
        </dl>
    </div>
        <dl>
        <dt>默认树 - AjaxTree 示例 - [同步&&异步]加载</dt>
        <dd>
            <div class="js_compAjaxTree js_labelTest" data-defaultOpenRoot="false" data-cajScriptData="|script">
                <script type="text/template">
                    {
                        root: ["folder","0",'root']
                        , url: "data/treedata.php?id={0}"
                        , data: 
                            {
                                "0": [
                                        ["folder","01","非异步节点01"],
                                        ["folder","02","非异步节点02"],
                                        ["folder","03","异步节点"],
                                        ["file","04","叶末节点"]
                                    ],
                                "01": [
                                        ["folder","0101","folder0101"],
                                        ["file","0102","file0102"],
                                        ["file","0103","file0103"]
                                    ],
                                "02": [
                                        ["file","0201","file0201"],
                                        ["file","0202","file0202"]
                                    ],
                                "0101": [
                                        ["file","010101","file010101"],
                                        ["file","010102","file010102"]
                                    ]

                            }
                    }
                </script>

                <script>

                $( document ).delegate( 'div.js_labelTest', 'renderItem', function( _evt, _item, _data ){
                    if( _data[1] == '0' ) {
                        return;
                    }
                    _item.html( JC.f.printf( '<label data-id="{0}"><input type="checkbox"  value="{0}"/>{1}</label>', _data[1], _data[2] ) );
                });
                </script>
            </div>
        </dd>
    </dl>
    <dl>
        <dt>默认树 - AjaxTree 示例 - [同步&&异步]加载</dt>
        <dd>
            <div class="js_compAjaxTree" data-cajScriptData="|script">
                <script type="text/template">
                    {
                        root: ["folder","0",'root']
                        , url: "data/treedata.php?id={0}"
                        , data: 
                            {
                                "0": [
                                        ["folder","01","非异步节点01"],
                                        ["folder","02","非异步节点02"],
                                        ["folder","03","异步节点"],
                                        ["file","04","叶末节点"]
                                    ],
                                "01": [
                                        ["folder","0101","folder0101"],
                                        ["file","0102","file0102"],
                                        ["file","0103","file0103"]
                                    ],
                                "02": [
                                        ["file","0201","file0201"],
                                        ["file","0202","file0202"]
                                    ],
                                "0101": [
                                        ["file","010101","file010101"],
                                        ["file","010102","file010102"]
                                    ]

                            }
                    }
                </script>
            </div>
        </dd>
    </dl>
    <dl>
        <dt>添加 a 链接 - AjaxTree 示例 - 同步加载</dt>
        <dd>
        <div class="js_compAjaxTree js_tree2" data-cajData="TREE_2" data-urlArgName="node">
            <script>
                window.TREE_2 = {
                    root: [ 'folder', "23",'客户发展部']
                    , data: 
                        {
                            "24":
                            [
                                [
                                    'file',
                                    "25", 
                                    "二组一队"
                                ], 
                                [
                                    'file',
                                    "26", 
                                    "二组二队"
                                ], 
                                [
                                    'file',
                                    "27", 
                                    "二组三队"
                                ]
                            ], 
                            "23":
                            [
                                [
                                    'file',
                                    "28", 
                                    "销售二组"
                                ], 
                                [
                                    'folder', 
                                    "24", 
                                    "售前审核组"
                                ]
                            ]
                        }
                };           

                $( document ).delegate( 'div.js_tree2', 'renderItem', function( _evt, _item, _data ){
                    _item.html( JC.f.printf( '<a href="?node={0}" data-id="{0}">{1}</a>', _data[1], _data[2] ) );
                });

            </script>
        </div>
        </dd>
    </dl>
    <dl>
        <dt>添加 a 链接, evt.preventDefault - AjaxTree 示例 - 同步加载</dt>
        <dd>
        <div class="js_compAjaxTree js_tree3" data-cajData="TREE_3" data-urlArgName="node">
            <script>
                window.TREE_3 = {
                    root: [ 'folder', "23",'客户发展部']
                    , data: 
                        {
                            "24":
                            [
                                [
                                    'file',
                                    "25", 
                                    "二组一队"
                                ], 
                                [
                                    'file',
                                    "26", 
                                    "二组二队"
                                ], 
                                [
                                    'file',
                                    "27", 
                                    "二组三队"
                                ]
                            ], 
                            "23":
                            [
                                [
                                    'file',
                                    "28", 
                                    "销售二组"
                                ], 
                                [
                                    'folder',
                                    "24", 
                                    "售前审核组"
                                ]
                            ]
                        }
                };           

                $( document ).delegate( 'div.js_tree3', 'renderItem', function( _evt, _item, _data ){
                    _item.html( JC.f.printf( '<a href="javascript:;" data-id="{0}">{1}</a>', _data[1], _data[2] ) );
                });

                $( document ).delegate( 'div.js_tree3', 'change', function( _evt, _item, _data, _box ){
                    //JC.dir( _item[0], _data, _box[0] );
                    //JC.log( 'tree3:', _data );
                });
            </script>
        </div>
        </dd>
    </dl>
</body>
</html>

