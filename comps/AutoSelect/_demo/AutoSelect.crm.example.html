<!doctype html>
<html>
    <head>
        <meta charset=utf-8 />
        <title>360 75 team</title>
        <style type='text/css'>
            body{
                width: 600px;
                margin: 20px auto 20px;
            }

            dl.def > dd{
                margin: 10px 0;
            }
        </style>
        <script src="../../../lib.js"></script>
        <script>
            if( /file\:|\\/.test( location.href ) ){
                alert('本示例需要HTTP环境');
            }

            JC.debug = true; JC.use('AutoSelect');

            $(document).ready(function(){

                //JC.AutoSelect.hideEmpty = true;

                $(document).delegate( 'button.js_ajaxTest', 'click', function(){
                    var _p = $(this);
                    _p.prop('disabled', true);
                    setTimeout( function(){ _p.prop('disabled', false); }, 1000 );

                    $.get( './data/shengshi_html.php?rnd='+new Date().getTime(), function( _r ){
                        var _selector = $(_r);
                        $( 'dl.def > dt' ).after( _selector );
                        JC.AutoSelect( _selector );
                    });
                });

                JC.AutoSelect.dataFilter = 
                    function( _data, _select ){
                        var _r = _data;
                        if( _data && !_data.length && _data.data ){
                            _r = _data.data;
                        }
                        return _r;
                    };

               JC.AutoSelect.inited =
                    function(){
                        JC.log( 'user inited' );
                    };

               JC.AutoSelect.allChanged =
                    function(){
                        JC.log( 'user allChanged' );
                    };
            });

            /**
             * 动态设置 选中值, 使用 update 方法
             */
             $(document).delegate( 'button.js_dynamicSettingUpdateMethod', 'click', function( _evt ){
                 var _p = $(this)
                 , _data = _p.attr('testdata')
                 , _ls
                 , _selLs
                 ;
                 if( !_data ) return;
                 _selLs = _p.parent().find('select');
                 if( !_selLs.length ) return;

                 var _ins = JC.AutoSelect.getInstance( _selLs[0] );
                    _ins && _ins.update( _data );
             });
        </script>
    </head>    
    <body>

        <div style="position:fixed; top: 20px; right: 20px">
            <button type="button" class="js_ajaxTest">ajax test</button>
        </div>

        <dl class='def'>
            <dt>auto select example</dt>

            <dd>
                <select name='select2_1' 
                    defaultselect 
                    selecturl="data/infinity_cat.php?id=0&hasData=1" 
                    selecttarget="/select:eq(1)"
                    selecthideempty="true"
                    >
                    <option value="" defaultoption>请选择</option>
                </select>
                <select name='select2_2' style="display:none;"  
                    selecturl="data/infinity_cat.php?id={0}&hasData=1" 
                    selecttarget="/select:eq(2)"
                    >
                    <option value="" defaultoption>请选择</option>
                </select>
                <select name='select2_2' style="display:none;"  
                    selecturl="data/infinity_cat.php?id={0}&hasData=1" 
                    selecttarget="/select:eq(3)"
                    >
                    <option value="" defaultoption>请选择</option>
                </select>
                <select name='select2_2' style="display:none;"  
                    selecturl="data/infinity_cat.php?id={0}&hasData=1" 
                    selecttarget="/select:eq(4)"
                    >
                    <option value="" defaultoption>请选择</option>
                </select>
                <select name='select2_2' style="display:none;"  
                    selecturl="data/infinity_cat.php?id={0}&hasData=1" 
                    selecttarget="/select:eq(5)"
                    >
                    <option value="" defaultoption>请选择</option>
                </select>
                <select name='select2_3' style="display:none;"  
                    selecturl="data/infinity_cat.php?id={0}&hasData=0"
                    >
                    <option value="" defaultoption>请选择</option>
                </select>
            </dd>


        </dl>

    </body>
</html>

