<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>../modules/JC.Calendar/0.3/Calendar.month.js - open jquery components library</title>
    <link rel="stylesheet" href="../assets/css/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="stylesheet" href="../assets/css/widget.css">
    <link rel="stylesheet" href="../assets/css/tabview.css">
    <link rel="shortcut icon" type="image/png" href="../assets/favicon.png">
    <script src="../assets/js/yui-min.js"></script>
    <script src="../assets/js/comps1.js"></script>
    <script src="../assets/js/comps2.js"></script>
    <script src="../assets/js/comps3.js"></script>
    <script src="../assets/js/comps4.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
            
                <h1><img src="../jc_logo.png" title="open jquery components library"></h1>
            
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.2</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
    <h2 class="off-left">APIs</h2>
    <div id="api-tabview" class="tabview">
        <ul class="tabs">
            <li><a href="#api-classes">Classes</a></li>
            <li><a href="#api-modules">Modules</a></li>
        </ul>

        <div id="api-tabview-filter">
            <input type="search" id="api-filter" placeholder="Type to filter APIs">
        </div>

        <div id="api-tabview-panel">
            <ul id="api-classes" class="apis classes">
            
                <li><a href="../classes/JC.AjaxTree.html">JC.AjaxTree</a></li>
            
                <li><a href="../classes/JC.AjaxUpload.html">JC.AjaxUpload</a></li>
            
                <li><a href="../classes/JC.alert.html">JC.alert</a></li>
            
                <li><a href="../classes/JC.AutoChecked.html">JC.AutoChecked</a></li>
            
                <li><a href="../classes/JC.AutoComplete.html">JC.AutoComplete</a></li>
            
                <li><a href="../classes/JC.AutoSelect.html">JC.AutoSelect</a></li>
            
                <li><a href="../classes/JC.Calendar.html">JC.Calendar</a></li>
            
                <li><a href="../classes/JC.common.html">JC.common</a></li>
            
                <li><a href="../classes/JC.confirm.html">JC.confirm</a></li>
            
                <li><a href="../classes/JC.Cover.html">JC.Cover</a></li>
            
                <li><a href="../classes/JC.DCalendar.html">JC.DCalendar</a></li>
            
                <li><a href="../classes/JC.Dialog.html">JC.Dialog</a></li>
            
                <li><a href="../classes/JC.Dialog.alert.html">JC.Dialog.alert</a></li>
            
                <li><a href="../classes/JC.Dialog.confirm.html">JC.Dialog.confirm</a></li>
            
                <li><a href="../classes/JC.Dialog.mask.html">JC.Dialog.mask</a></li>
            
                <li><a href="../classes/JC.Dialog.msgbox.html">JC.Dialog.msgbox</a></li>
            
                <li><a href="../classes/JC.Drag.html">JC.Drag</a></li>
            
                <li><a href="../classes/JC.DragSelect.html">JC.DragSelect</a></li>
            
                <li><a href="../classes/JC.f.html">JC.f</a></li>
            
                <li><a href="../classes/JC.FChart.html">JC.FChart</a></li>
            
                <li><a href="../classes/JC.Fixed.html">JC.Fixed</a></li>
            
                <li><a href="../classes/JC.FlowChart.html">JC.FlowChart</a></li>
            
                <li><a href="../classes/JC.FormFillUrl.html">JC.FormFillUrl</a></li>
            
                <li><a href="../classes/JC.FrameUtil.html">JC.FrameUtil</a></li>
            
                <li><a href="../classes/JC.hideAllPanel.html">JC.hideAllPanel</a></li>
            
                <li><a href="../classes/JC.hideAllPopup.html">JC.hideAllPopup</a></li>
            
                <li><a href="../classes/JC.ImageCutter.html">JC.ImageCutter</a></li>
            
                <li><a href="../classes/JC.LunarCalendar.html">JC.LunarCalendar</a></li>
            
                <li><a href="../classes/JC.LunarCalendar.Model.html">JC.LunarCalendar.Model</a></li>
            
                <li><a href="../classes/JC.LunarCalendar.View.html">JC.LunarCalendar.View</a></li>
            
                <li><a href="../classes/JC.msgbox.html">JC.msgbox</a></li>
            
                <li><a href="../classes/JC.NumericStepper.html">JC.NumericStepper</a></li>
            
                <li><a href="../classes/JC.Paginator.html">JC.Paginator</a></li>
            
                <li><a href="../classes/JC.Panel.html">JC.Panel</a></li>
            
                <li><a href="../classes/JC.Panel.Model.html">JC.Panel.Model</a></li>
            
                <li><a href="../classes/JC.Panel.View.html">JC.Panel.View</a></li>
            
                <li><a href="../classes/JC.Placeholder.html">JC.Placeholder</a></li>
            
                <li><a href="../classes/JC.PopTips.html">JC.PopTips</a></li>
            
                <li><a href="../classes/JC.Rate.html">JC.Rate</a></li>
            
                <li><a href="../classes/JC.Scrollbar.html">JC.Scrollbar</a></li>
            
                <li><a href="../classes/JC.ServerSort.html">JC.ServerSort</a></li>
            
                <li><a href="../classes/JC.Slider.html">JC.Slider</a></li>
            
                <li><a href="../classes/JC.Slider.Model.html">JC.Slider.Model</a></li>
            
                <li><a href="../classes/JC.StepControl.html">JC.StepControl</a></li>
            
                <li><a href="../classes/JC.Suggest.html">JC.Suggest</a></li>
            
                <li><a href="../classes/JC.Tab.html">JC.Tab</a></li>
            
                <li><a href="../classes/JC.Tab.Model.html">JC.Tab.Model</a></li>
            
                <li><a href="../classes/JC.Tab.View.html">JC.Tab.View</a></li>
            
                <li><a href="../classes/JC.TableFreeze.html">JC.TableFreeze</a></li>
            
                <li><a href="../classes/JC.Tips.html">JC.Tips</a></li>
            
                <li><a href="../classes/JC.Tips.Model.html">JC.Tips.Model</a></li>
            
                <li><a href="../classes/JC.Tips.View.html">JC.Tips.View</a></li>
            
                <li><a href="../classes/JC.Tree.html">JC.Tree</a></li>
            
                <li><a href="../classes/JC.Tree.Model.html">JC.Tree.Model</a></li>
            
                <li><a href="../classes/JC.Valid.html">JC.Valid</a></li>
            
                <li><a href="../classes/window.Bizs.ActionLogic.html">window.Bizs.ActionLogic</a></li>
            
                <li><a href="../classes/window.Bizs.AutoSelectComplete.html">window.Bizs.AutoSelectComplete</a></li>
            
                <li><a href="../classes/window.Bizs.ChangeLogic.html">window.Bizs.ChangeLogic</a></li>
            
                <li><a href="../classes/window.Bizs.CommonModify.html">window.Bizs.CommonModify</a></li>
            
                <li><a href="../classes/window.Bizs.CRMSchedule.html">window.Bizs.CRMSchedule</a></li>
            
                <li><a href="../classes/window.Bizs.CustomColumn.html">window.Bizs.CustomColumn</a></li>
            
                <li><a href="../classes/window.Bizs.DisableLogic.html">window.Bizs.DisableLogic</a></li>
            
                <li><a href="../classes/window.Bizs.DMultiDate.html">window.Bizs.DMultiDate</a></li>
            
                <li><a href="../classes/window.Bizs.DropdownTree.html">window.Bizs.DropdownTree</a></li>
            
                <li><a href="../classes/window.Bizs.FormLogic.html">window.Bizs.FormLogic</a></li>
            
                <li><a href="../classes/window.Bizs.InputSelect.html">window.Bizs.InputSelect</a></li>
            
                <li><a href="../classes/window.Bizs.KillISPCache.html">window.Bizs.KillISPCache</a></li>
            
                <li><a href="../classes/window.Bizs.MoneyTips.html">window.Bizs.MoneyTips</a></li>
            
                <li><a href="../classes/window.Bizs.MultiAutoComplete.html">window.Bizs.MultiAutoComplete</a></li>
            
                <li><a href="../classes/window.Bizs.MultiDate.html">window.Bizs.MultiDate</a></li>
            
                <li><a href="../classes/window.Bizs.MultiSelect.html">window.Bizs.MultiSelect</a></li>
            
                <li><a href="../classes/window.Bizs.MultiselectPanel.html">window.Bizs.MultiselectPanel</a></li>
            
                <li><a href="../classes/window.Bizs.MultiSelectTree.html">window.Bizs.MultiSelectTree</a></li>
            
                <li><a href="../classes/window.Bizs.MultiUpload.html">window.Bizs.MultiUpload</a></li>
            
                <li><a href="../classes/window.Bizs.TaskViewer.html">window.Bizs.TaskViewer</a></li>
            
                <li><a href="../classes/window.jQuery.html">window.jQuery</a></li>
            
                <li><a href="../classes/window.jQuery.mousewheel.html">window.jQuery.mousewheel</a></li>
            
                <li><a href="../classes/window.JSON.html">window.JSON</a></li>
            
                <li><a href="../classes/window.Raphael.html">window.Raphael</a></li>
            
                <li><a href="../classes/window.requirejs.html">window.requirejs</a></li>
            
                <li><a href="../classes/window.swfobject.html">window.swfobject</a></li>
            
            </ul>

            <ul id="api-modules" class="apis modules">
            
            </ul>
        </div>
    </div>
</div>

            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
        Show:
        <label for="api-show-inherited">
            <input type="checkbox" id="api-show-inherited" checked>
            Inherited
        </label>

        <label for="api-show-protected">
            <input type="checkbox" id="api-show-protected">
            Protected
        </label>

        <label for="api-show-private">
            <input type="checkbox" id="api-show-private">
            Private
        </label>
        <label for="api-show-deprecated">
            <input type="checkbox" id="api-show-deprecated">
            Deprecated
        </label>

    </div>


            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
                        <h1 class="file-heading">File: ../modules/JC.Calendar/0.3/Calendar.month.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
;(function(define, _win) { &#x27;use strict&#x27;; define( [ &#x27;JC.Calendar.date&#x27; ], function(){
    //
    /// MONTH CODE
    //
    /**
     * 自定义月份弹框的模板HTML
     * @for         JC.Calendar
     * @property    monthTpl
     * @type        string
     * @default     empty
     * @static
     */
    JC.Calendar.monthTpl = &#x27;&#x27;;

    function MonthModel( _selector ){
        this._selector = _selector;
    }
    JC.Calendar.MonthModel = MonthModel;
    
    function MonthView( _model ){
        this._model = _model;
    }
    JC.Calendar.MonthView = MonthView;

    JC.Calendar.clone( MonthModel, MonthView );

    JC.f.extendObject( MonthModel.prototype, {
        layout:
            function(){
                var _r = $(&#x27;#UXCCalendar_month&#x27;);

                if( !_r.length ){
                    _r = $( JC.Calendar.monthTpl || this.tpl ).hide();
                    _r.attr(&#x27;id&#x27;, &#x27;UXCCalendar_month&#x27;).hide().appendTo( document.body );
                 }
                return _r;
            }

        , tpl:
            [
            &#x27;&lt;div id=&quot;UXCCalendar_month&quot; class=&quot;UXCCalendar UXCCalendar_week UXCCalendar_month&quot; &gt;&#x27;
            ,&#x27;    &lt;div class=&quot;UHeader&quot;&gt;&#x27;
            ,&#x27;        &lt;button type=&quot;button&quot; class=&quot;UButton UNextYear&quot;&gt;&amp;nbsp;&amp;gt;&amp;gt;&amp;nbsp;&lt;/button&gt;&#x27;
            ,&#x27;        &lt;button type=&quot;button&quot; class=&quot;UButton UPreYear&quot;&gt;&amp;nbsp;&amp;lt;&amp;lt;&amp;nbsp;&lt;/button&gt;&#x27;
            ,&#x27;        &lt;select class=&quot;UYear&quot; style=&quot;&quot;&gt;&lt;/select&gt;&#x27;
            ,&#x27;    &lt;/div&gt;&#x27;
            ,&#x27;    &lt;table class=&quot;UTable UTableBorder&quot;&gt;&#x27;
            ,&#x27;        &lt;tbody&gt;&lt;/tbody&gt;&#x27;
            ,&#x27;    &lt;/table&gt;&#x27;
            ,&#x27;    &lt;div class=&quot;UFooter&quot;&gt;&#x27;
            ,&#x27;        &lt;button type=&quot;button&quot; class=&quot;UConfirm&quot;&gt;确定&lt;/button&gt;&#x27;
            ,&#x27;        &lt;button type=&quot;button&quot; class=&quot;UClear&quot;&gt;清空&lt;/button&gt;&#x27;
            ,&#x27;        &lt;button type=&quot;button&quot; class=&quot;UCancel&quot;&gt;取消&lt;/button&gt;&#x27;
            ,&#x27;    &lt;/div&gt;&#x27;
            ,&#x27;&lt;/div&gt;&#x27;
            ].join(&#x27;&#x27;)

        , month:
            function(){
                var _r = 0, _tmp, _date;
                ( _tmp = this.layout().find(&#x27;td.cur a[dstart]&#x27;) ).length
                    &amp;&amp; ( _date = new Date() )
                    &amp;&amp; (
                            _date.setTime( _tmp.attr(&#x27;dstart&#x27;) )
                            , _r = _date.getMonth()
                       )
                    ;
                return _r;
            }

        , selectedDate:
            function(){
                var _r, _tmp, _item;
                _tmp = this.layout().find(&#x27;td.cur&#x27;);
                _tmp.length 
                    &amp;&amp; !_tmp.hasClass( &#x27;unable&#x27; )
                    &amp;&amp; ( _item = _tmp.find(&#x27;a[dstart]&#x27;) )
                    &amp;&amp; ( 
                            _r = { &#x27;start&#x27;: new Date(), &#x27;end&#x27;: new Date() }
                            , _r.start.setTime( _item.attr(&#x27;dstart&#x27;) ) 
                            , _r.end.setTime( _item.attr(&#x27;dend&#x27;) ) 
                        )
                    ;
                return _r;
            }

        , multiselectDate:
            function(){
                var _p = this, _r = [], _sp, _item, _dstart, _dend;
                _p.layout().find(&#x27;td.cur&#x27;).each( function(){
                    _sp = $(this); _item = _sp.find( &#x27;&gt; a[dstart]&#x27; );
                    if( _sp.hasClass( &#x27;unable&#x27; ) ) return;
                    _dstart = new Date(); _dend = new Date();
                    _dstart.setTime( _item.attr(&#x27;dstart&#x27;) );
                    _dend.setTime( _item.attr(&#x27;dend&#x27;) );
                    _r.push( { &#x27;start&#x27;: _dstart, &#x27;end&#x27;: _dend } );
                });
                return _r;
            }
    });

    JC.f.extendObject( MonthView.prototype, {
        _buildBody: 
            function( _dateo ){
                var _p = this
                    , _date = _dateo.date
                    , _layout = _p._model.layout()
                    , today = new Date( new Date().getFullYear(), new Date().getMonth(), new Date().getDate() ).getTime()
                    , nextCount = 0
                    , _ls = [], _class, _data, _title, _dstart, _dend, _year = _date.getFullYear()
                    , _rows = 4
                    , ipt = JC.Calendar.lastIpt
                    , currentcanselect = JC.f.parseBool( ipt.attr(&#x27;currentcanselect&#x27;) )
                    , _tmpMultidate = _dateo.multidate ? _dateo.multidate.slice() : null
                    , _minvalue = _dateo.minvalue ? JC.f.cloneDate( _dateo.minvalue ) : null
                    , _maxvalue = _dateo.maxvalue ? JC.f.cloneDate( _dateo.maxvalue ) : null
                    ;

                    if( _maxvalue &amp;&amp; currentcanselect ){
                        _maxvalue.setDate( JC.f.maxDayOfMonth( _maxvalue ) );
                    }

                    if( _minvalue &amp;&amp; currentcanselect ){
                        _minvalue.setDate( 1 );
                    }

                    _ls.push(&#x27;&lt;tr&gt;&#x27;);
                    for( var i = 1, j = 12; i &lt;= j; i++ ){
                        _dstart = new Date( _year, i - 1, 1 ); 
                        _dend = new Date( _year, i - 1, JC.f.maxDayOfMonth( _dstart ) );

                        _title = JC.f.printf( &quot;{0}年 {1}月\n开始日期: {2} (周{4})\n结束日期: {3} (周{5})&quot;
                                    , _year
                                    , JC.Calendar.getCnNum( i )
                                    , JC.f.formatISODate( _dstart )
                                    , JC.f.formatISODate( _dend )
                                    , JC.Calendar.cnWeek.charAt( _dstart.getDay() % 7 )
                                    , JC.Calendar.cnWeek.charAt( _dend.getDay() % 7 )
                                    );

                        _class = [];

                        if( _minvalue &amp;&amp; _dstart.getTime() &lt; _minvalue.getTime() ) 
                            _class.push( &#x27;unable&#x27; );
                        if( _maxvalue &amp;&amp; _dend.getTime() &gt; _maxvalue.getTime() ){
                            _class.push( &#x27;unable&#x27; );
                        }

                        if( _tmpMultidate ){
                            $.each( _tmpMultidate, function( _ix, _item ){
                                if( _dstart.getTime() &gt;= _item.start.getTime() 
                                  &amp;&amp; _dstart.getTime() &lt;= _item.end.getTime() ){
                                    _class.push( &#x27;cur&#x27; );
                                    _tmpMultidate.splice( _ix, 1 );
                                    return false;
                                }
                            });
                        }else{
                            if( _date.getTime() &gt;= _dstart.getTime() 
                                    &amp;&amp; _date.getTime() &lt;= _dend.getTime() ) _class.push( &#x27;cur&#x27; );
                        }
                        if( today &gt;= _dstart.getTime() &amp;&amp; today &lt;= _dend.getTime() ) _class.push( &#x27;today&#x27; );

                        var _cnUnit = JC.Calendar.cnUnit.charAt( i % 10 );
                        i &gt; 10 &amp;&amp; ( _cnUnit = &quot;十&quot; + _cnUnit );

                        _ls.push( JC.f.printf( &#x27;&lt;td class=&quot;{0}&quot;&gt;&lt;a href=&quot;javascript:&quot; title=&quot;{1}&quot;&#x27;+
                                        &#x27; dstart=&quot;{3}&quot; dend=&quot;{4}&quot; month=&quot;{5}&quot; &gt;{2}月&lt;/a&gt;&lt;/td&gt;&#x27;
                                    , _class.join(&#x27; &#x27;)
                                    , _title
                                    , _cnUnit
                                    , _dstart.getTime()
                                    , _dend.getTime()
                                    , i
                                ));
                        if( i % 3 === 0 &amp;&amp; i != j ) _ls.push( &#x27;&lt;/tr&gt;&lt;tr&gt;&#x27; );
                    }
                    _ls.push(&#x27;&lt;/tr&gt;&#x27;); 
     
                    _layout.find(&#x27;table.UTableBorder tbody&#x27; ).html( $( _ls.join(&#x27;&#x27;) ) );
            }

        , updateSelected:
            function( _userSelectedItem ){
                var _p = this, _dstart, _dend, _tmp, _text, _ar;
                if( !_userSelectedItem ){
                    if( _p._model.multiselect() ){
                        _tmp = this._model.multiselectDate();
                        if( !_tmp.length ) return;
                        _ar = [];
                        $.each( _tmp, function( _ix, _item ){
                            //_ar.push( JC.f.printf( &#x27;{0} 至 {1}&#x27;, JC.f.formatISODate( _item.start ), JC.f.formatISODate( _item.end ) ) );
                            _ar.push( _text = _p._model.fullFormat( _p._model.dateFormat( _item.start ), _p._model.dateFormat( _item.end ) ) );
                        });
                        _text = _ar.join(&#x27;,&#x27;);
                    }else{
                        _tmp = this._model.selectedDate();
                        _tmp &amp;&amp; ( _dstart = _tmp.start, _dend = _tmp.end );

                        /*
                        _dstart &amp;&amp; _dend 
                            &amp;&amp; ( _text = JC.f.printf( &#x27;{0} 至 {1}&#x27;, JC.f.formatISODate( _dstart ), JC.f.formatISODate( _dend ) ) );
                        */
                        _dstart 
                            &amp;&amp; _dend 
                            &amp;&amp; ( _text = _p._model.fullFormat( _p._model.dateFormat( _dstart ), _p._model.dateFormat( _dend ) ) )
                            ; 
                    }
                }else{
                    _userSelectedItem = $( _userSelectedItem );
                    _tmp = JC.f.getJqParent( _userSelectedItem, &#x27;td&#x27; );
                    if( _tmp &amp;&amp; _tmp.hasClass(&#x27;unable&#x27;) ) return;

                    if( _p._model.multiselect() ){
                        _tmp.toggleClass(&#x27;cur&#x27;);
                        return;
                    }
                    _dstart = new Date(); _dend = new Date();
                    _dstart.setTime( _userSelectedItem.attr(&#x27;dstart&#x27;) );
                    _dend.setTime( _userSelectedItem.attr(&#x27;dend&#x27;) );

                    /*
                    _text = JC.f.printf( &#x27;{0} 至 {1}&#x27;, JC.f.formatISODate( _dstart ), JC.f.formatISODate( _dend ) );
                    */
                    _text = _p._model.fullFormat( _p._model.dateFormat( _dstart ), _p._model.dateFormat( _dend ) )
                }

                if( !_text ) return;

                _p._model.selector().val( _text );
                $(_p).trigger( &#x27;TriggerEvent&#x27;, [ JC.Calendar.Model.UPDATE, &#x27;month&#x27;, _dstart, _dend ] );

                JC.Calendar.hide();
            }
    });

    $(document).delegate( [ &#x27;input[datatype=month]&#x27;, &#x27;input[multidate=month]&#x27; ].join(), &#x27;focus&#x27; 
    , function($evt){
            Calendar.pickDate( this );
    });
    $(document).delegate( [ &#x27;button[datatype=month]&#x27;, &#x27;button[multidate=month]&#x27; ].join(), &#x27;click&#x27; , function($evt){
            Calendar.pickDate( this );
    });
    $(document).delegate( [ &#x27;textarea[datatype=month]&#x27;, &#x27;textarea[multidate=month]&#x27; ].join(), &#x27;click&#x27; , function($evt){
            Calendar.pickDate( this );
    });

    return JC.Calendar;
});}( typeof define === &#x27;function&#x27; &amp;&amp; define.amd ? define : 
        function ( _name, _require, _cb ) { 
            typeof _name == &#x27;function&#x27; &amp;&amp; ( _cb = _name );
            typeof _require == &#x27;function&#x27; &amp;&amp; ( _cb = _require ); 
            _cb &amp;&amp; _cb(); 
        }
        , window
    )
);

    </pre>
</div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
